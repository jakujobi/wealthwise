{% extends "base.html" %}
{% load static %}
{% block content %}
<div class="calculator-header py-4 text-center">
  <div class="container">
    <h1 class="display-5 fw-bold mb-2">Budgeting Tool</h1>
    <p class="lead mb-0">Plan your finances and track your spending to meet your savings goals</p>
  </div>
</div>

<div class="container py-5">
  <div class="row">
    <!-- Calculator Form -->
    <div class="col-lg-7 mb-4 mb-lg-0">
      <div class="calculator-card">
        <div class="calculator-card-header p-4">
          <h2 class="h4 mb-0"><i class="bi bi-wallet2 me-2"></i>Budget Details</h2>
        </div>
        <div class="calculator-card-body p-4">
          <form method="POST" class="calculator-form">
            {% csrf_token %}
            
            <div class="budget-section mb-4">
              <h3 class="h5 mb-3"><i class="bi bi-cash-coin me-2"></i>Income</h3>
              <div class="row g-3">
                <div class="col-md-6">
                  <div class="form-floating mb-3">
                    <input type="number" step="0.01" name="fixed_income" id="fixed_income" class="form-control" placeholder="Fixed Income" required />
                    <label for="fixed_income">Fixed Income ($)</label>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-floating mb-3">
                    <input type="number" step="0.01" name="variable_income" id="variable_income" class="form-control" placeholder="Variable Income" required />
                    <label for="variable_income">Variable Income ($)</label>
                  </div>
                </div>
                <div class="col-md-12">
                  <div class="form-floating mb-3">
                    <input type="number" step="0.01" name="one_year_savings_goal" id="one_year_savings_goal" class="form-control" placeholder="One Year Savings Goal" required />
                    <label for="one_year_savings_goal">One Year Savings Goal ($)</label>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="budget-section mb-4">
              <h3 class="h5 mb-3"><i class="bi bi-house me-2"></i>Housing & Essentials</h3>
              <div class="row g-3">
                <div class="col-md-6">
                  <div class="form-floating mb-3">
                    <input type="number" step="0.01" name="housing" id="housing" class="form-control" placeholder="Housing" required />
                    <label for="housing">Housing ($)</label>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-floating mb-3">
                    <input type="number" step="0.01" name="utilities" id="utilities" class="form-control" placeholder="Utilities" required />
                    <label for="utilities">Utilities ($)</label>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-floating mb-3">
                    <input type="number" step="0.01" name="taxes" id="taxes" class="form-control" placeholder="Taxes" required />
                    <label for="taxes">Taxes ($)</label>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-floating mb-3">
                    <input type="number" step="0.01" name="medical" id="medical" class="form-control" placeholder="Medical" required />
                    <label for="medical">Medical ($)</label>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="budget-section mb-4">
              <h3 class="h5 mb-3"><i class="bi bi-car-front me-2"></i>Transportation</h3>
              <div class="row g-3">
                <div class="col-md-6">
                  <div class="form-floating mb-3">
                    <input type="number" step="0.01" name="car_payment" id="car_payment" class="form-control" placeholder="Car Payment" required />
                    <label for="car_payment">Car Payment ($)</label>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-floating mb-3">
                    <input type="number" step="0.01" name="transportation" id="transportation" class="form-control" placeholder="Transportation" required />
                    <label for="transportation">Other Transportation ($)</label>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="budget-section mb-4">
              <h3 class="h5 mb-3"><i class="bi bi-basket me-2"></i>Daily Living</h3>
              <div class="row g-3">
                <div class="col-md-6">
                  <div class="form-floating mb-3">
                    <input type="number" step="0.01" name="food" id="food" class="form-control" placeholder="Food" required />
                    <label for="food">Food ($)</label>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-floating mb-3">
                    <input type="number" step="0.01" name="personal_items" id="personal_items" class="form-control" placeholder="Personal Items" required />
                    <label for="personal_items">Personal Items ($)</label>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="budget-section mb-4">
              <h3 class="h5 mb-3"><i class="bi bi-tv me-2"></i>Lifestyle & Discretionary</h3>
              <div class="row g-3">
                <div class="col-md-6">
                  <div class="form-floating mb-3">
                    <input type="number" step="0.01" name="entertainment" id="entertainment" class="form-control" placeholder="Entertainment" required />
                    <label for="entertainment">Entertainment ($)</label>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-floating mb-3">
                    <input type="number" step="0.01" name="subscriptions" id="subscriptions" class="form-control" placeholder="Subscriptions" required />
                    <label for="subscriptions">Subscriptions ($)</label>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-floating mb-3">
                    <input type="number" step="0.01" name="internet_phone" id="internet_phone" class="form-control" placeholder="Internet and Phone" required />
                    <label for="internet_phone">Internet & Phone ($)</label>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-floating mb-3">
                    <input type="number" step="0.01" name="misc" id="misc" class="form-control" placeholder="Miscellaneous" required />
                    <label for="misc">Miscellaneous ($)</label>
                  </div>
                </div>
              </div>
            </div>
            
            <button type="submit" class="btn btn-primary btn-lg w-100">
              <i class="bi bi-calculator me-2"></i>Analyze Budget
            </button>
          </form>
          
          <div class="calculator-tips mt-4">
            <h3 class="h5 mb-3"><i class="bi bi-lightbulb me-2"></i>Budgeting Tips</h3>
            <ul class="calculator-tips-list">
              <li>Try to follow the 50/30/20 rule: 50% on needs, 30% on wants, 20% on savings</li>
              <li>Track your spending for a month to identify areas where you can cut back</li>
              <li>Set up automatic transfers to your savings account on payday</li>
              <li>Review and adjust your budget quarterly as your financial situation changes</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Results Section -->
    <div class="col-lg-5">
      {% if overspend_areas or savings_goal_message %}
      <div class="calculator-card">
        <div class="calculator-card-header p-4">
          <h2 class="h4 mb-0"><i class="bi bi-graph-up me-2"></i>Budget Analysis</h2>
        </div>
        <div class="calculator-card-body p-4">
          {% if overspend_areas %}
          <div class="alert alert-warning mb-4">
            <h3 class="h5 mb-3"><i class="bi bi-exclamation-triangle me-2"></i>Spending Alerts</h3>
            <div class="overspend-areas">
              {{ overspend_areas|linebreaks }}
            </div>
          </div>
          {% endif %}
          
          {% if savings_goal_message %}
          <div class="savings-goal-section mb-4">
            <h3 class="h5 mb-3"><i class="bi bi-piggy-bank me-2"></i>Savings Goal</h3>
            <div class="savings-goal-message p-3 border rounded">
              {{ savings_goal_message }}
            </div>
          </div>
          {% endif %}
          
          <div class="budget-summary mt-4">
            <h3 class="h5 mb-3">Budget Summary</h3>
            <div class="row g-3">
              <div class="col-6">
                <div class="result-item">
                  <span class="result-item-label">Total Income</span>
                  <span class="result-item-value">${{ total_income|default:"0.00" }}</span>
                </div>
              </div>
              <div class="col-6">
                <div class="result-item">
                  <span class="result-item-label">Total Expenses</span>
                  <span class="result-item-value">${{ total_expenses|default:"0.00" }}</span>
                </div>
              </div>
              <div class="col-6">
                <div class="result-item">
                  <span class="result-item-label">Monthly Surplus</span>
                  <span class="result-item-value">${{ monthly_surplus|default:"0.00" }}</span>
                </div>
              </div>
              <div class="col-6">
                <div class="result-item">
                  <span class="result-item-label">Annual Savings</span>
                  <span class="result-item-value">${{ annual_savings|default:"0.00" }}</span>
                </div>
              </div>
            </div>
          </div>
          
          <div class="d-flex justify-content-between mt-4">
            <a href="{% url 'calculators_home' %}" class="btn btn-outline-secondary">
              <i class="bi bi-arrow-left me-2"></i>Back to Calculators
            </a>
            <button class="btn btn-outline-primary" onclick="window.print()">
              <i class="bi bi-printer me-2"></i>Print Results
            </button>
          </div>
        </div>
      </div>
      {% else %}
      <div class="calculator-card h-100 d-flex flex-column justify-content-center align-items-center p-5">
        <div class="empty-state text-center">
          <img src="{% static 'images/calculator-illustration.svg' %}" alt="Calculator" class="empty-state-image mb-4" style="max-width: 200px;">
          <h3 class="h4 mb-3">No Results Yet</h3>
          <p class="text-muted mb-0">Fill out the form to analyze your budget and savings plan</p>
        </div>
      </div>
      {% endif %}
    </div>
  </div>
</div>
{% endblock content %}
